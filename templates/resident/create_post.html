{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        
        <div class="d-flex align-items-center mb-4">
            <a href="/community" class="btn btn-light rounded-circle me-3"><i class="bi bi-arrow-left"></i></a>
            <h4 class="fw-bold m-0">Create New Post</h4>
        </div>

        <div class="card shadow-sm border-0 p-4">
            {% if error %}
            <div class="alert alert-danger" role="alert">{{ error }}</div>
            {% endif %}
            <form method="POST" enctype="multipart/form-data">
                <div class="mb-4">
                    <label class="form-label fw-bold small text-uppercase">Image</label>
                    <div class="text-center p-5 border border-2 border-dashed rounded-4 bg-light text-muted position-relative" id="imageUploadArea">
                        <i class="bi bi-camera fs-1 mb-2 d-block"></i>
                        <span class="small">Click to upload photos</span>
                        <input type="file" name="image" id="imageInput" accept="image/*" class="position-absolute top-0 start-0 w-100 h-100 opacity-0" style="cursor: pointer;">
                    </div>
                    <div id="imagePreview" class="mt-3 d-none">
                        <img id="previewImg" src="" alt="Preview" class="img-thumbnail" style="max-height: 200px;">
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label fw-bold small text-uppercase">Title</label>
                    <input type="text" name="title" class="form-control form-control-lg bg-light border-0" placeholder="e.g. Free Homemade Cookies" required>
                </div>

                <div class="mb-3">
                    <label class="form-label fw-bold small text-uppercase">Category</label>
                    <div class="d-flex gap-2">
                        <input type="radio" class="btn-check" name="category" id="cat1" value="Food" checked required>
                        <label class="btn btn-outline-secondary rounded-pill btn-sm px-3" for="cat1">Food</label>

                        <input type="radio" class="btn-check" name="category" id="cat2" value="Furniture" required>
                        <label class="btn btn-outline-secondary rounded-pill btn-sm px-3" for="cat2">Furniture</label>
                        
                        <input type="radio" class="btn-check" name="category" id="cat3" value="Other" required>
                        <label class="btn btn-outline-secondary rounded-pill btn-sm px-3" for="cat3">Other</label>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="form-label fw-bold small text-uppercase">Description</label>
                    <textarea name="description" class="form-control bg-light border-0" rows="5" placeholder="Describe your item, pick-up time, etc." required></textarea>
                </div>

                <div class="d-grid">
                    <button type="submit" class="btn btn-dark btn-lg">Post to Community</button>
                </div>
            </form>
        </div>

        <script>
            document.getElementById('imageInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('previewImg').src = e.target.result;
                        document.getElementById('imagePreview').classList.remove('d-none');
                    };
                    reader.readAsDataURL(file);
                }
            });
        </script>

    </div>
</div>
{% endblock %}